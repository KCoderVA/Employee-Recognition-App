<!--
  Employee Recognition App - v1.1.2 Release Message
  Copyright 2025 Kyle J. Coder

  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
-->

# Employee Recognition App v1.1.2 Release Message

**Release Date:** January 13, 2026
**Release Type:** Major Feature Update â€“ Triage Workflow Overhaul, Office365 API Migration, Platform Modernization
**Previous Version:** v1.0.6
**Developer:** Kyle J. Coder (Advanced Analytics & Informatics)

---

## ðŸ“‹ Executive Summary

Version 1.1.2 delivers a significant upgrade to the Employee Recognition Canvas App, with a complete redesign of the Triage Screen, migration to updated Office365 APIs, enhanced form controls with dynamic visibility, and platform component upgrades. This release represents a major step forward in user experience for triage team members and introduces smart form handling with conditional display logic.

---

## ðŸ”„ Detailed Change Analysis (v1.0.6 â†’ v1.1.2)

### 1. App Manifest & Platform Changes

#### CanvasManifest.json

| Attribute               | v1.0.6            | v1.1.2                                                     | Impact                                        |
| ----------------------- | ----------------- | ---------------------------------------------------------- | --------------------------------------------- |
| `DocVersion`            | 1.346             | 1.347                                                      | Minor platform iteration                      |
| `MSAppStructureVersion` | 2.0               | 2.4.0                                                      | Major structure upgrade enabling new features |
| `AppDescription`        | Basic description | Extended with GitHub repository link and version reference | Improved traceability and discoverability     |

#### Preview Flags Changed

| Flag                              | v1.0.6 | v1.1.2    | Notes                           |
| --------------------------------- | ------ | --------- | ------------------------------- |
| `enablecopilotanswercontrol`      | true   | false     | Copilot answer control disabled |
| `enablecopilotcontrol`            | true   | false     | Copilot control disabled        |
| `enableideaspanel`                | true   | (removed) | Ideas panel flag removed        |
| `enableideaspanelbyexample`       | false  | (removed) | Flag removed                    |
| `enableeditcacherefreshfrequency` | false  | (removed) | Flag removed                    |
| `enablelegacydatatable`           | false  | (removed) | Legacy table flag removed       |
| `formularepair`                   | true   | (removed) | Formula repair flag removed     |
| `reliableconcurrent`              | true   | (removed) | Flag removed                    |
| `disablecdsfileandlargeimage`     | false  | (removed) | CDS flag removed                |

---

### 2. App.fx.yaml â€“ Core Application Logic

#### Office365 API Migration

```diff
- Office365Users.SearchUserV2({searchTerm:(gbl_userCurrentEmail)})
+ Office365Users.SearchUser({searchTerm:(gbl_userCurrentEmail)})
```

**Impact:** Migrated from `SearchUserV2` to `SearchUser` API method. This aligns with current Office365Users connector best practices and may indicate a platform compatibility update.

#### Version Number Update

```diff
- Concatenate("1.0.", "5")
+ Concatenate("1.1.", "1")
```

**Impact:** In-app version display now shows `1.1.1` (reflecting the source version at time of export, will display as 1.1.2 upon final publication).

---

### 3. Triage_Screen.fx.yaml â€“ Complete Workflow Redesign

This screen underwent the most significant changes in this release, growing from **1,460 lines to 2,415 lines** (+955 lines, +65% increase).

#### 3.1 Screen-Level Changes

```diff
  "Triage_Screen As screen.'printableLayout_A4Landscape_ver1.0'":
      Height: =768
+     OnVisible: =Form2.Visible = false
      Width: =1366
```

**Impact:** Added screen-level `OnVisible` logic to hide Form2 by default until a nomination is selected.

#### 3.2 Navigation Button Enhancements

```diff
  btn_GoHome As label:
      ...
+     BorderColor: =RGBA(0, 0, 0, 1)
-     DisabledColor: =RGBA(166, 166, 166, 1)
      ...
+     Y: =btn_GoHome.Y
-     Y: =32
```

**Impact:** Improved button styling and relative positioning.

```diff
  btn_Print As label:
      ...
+     X: =btn_GoHome.X + btn_GoHome.Width + 10
+     Y: =btn_GoHome.Y
-     X: =1027
-     Y: =32
```

**Impact:** Print button now positioned relative to GoHome button for consistent layout.

#### 3.3 Form2 â€“ Complete Redesign

The triage form was extensively redesigned with new controls and dynamic behavior:

```diff
  Form2 As form.PowerApps_CoreControls_Form:
+     BorderThickness: =3
      DataSource: ='578_Starfish'
+     Height: =Parent.Height - ctn_SearchBar.Y
-     Height: =612
      Item: =Gallery1.Selected
      NumberOfColumns: =2
      UseFluentV9Cards: =true
+     Visible: |-
+         =If(
+             CountRows(col_selectedUserNominee) < 1,
+             false,
+             true
+         )
-     Visible: =true
+     Width: =(Parent.Width / 3) * 2
-     Width: =700
+     X: =ctn_SearchBar.X + ctn_SearchBar.Width
-     X: =665
+     Y: =ctn_SearchBar.Y
-     Y: =156
```

**Key Changes:**

- **Dynamic visibility** based on `col_selectedUserNominee` collection count
- **Responsive sizing** using relative calculations instead of fixed pixels
- **Border styling** added for visual clarity
- **Relative positioning** tied to search bar component

#### 3.4 New Submit Button with Form Reset

```yaml
DataCard3 As typedDataCard.blankCard:
    ...
    ButtonCanvas5_1 As Button:
        Text: ="Submit Changes"
        OnSelect: |
            =Reset(DataCardValue50);
            SubmitForm(Form2);

            Set(var_selectedUser, Blank());
            Set(var_selectedUser_Manager, Blank());
            Set(var_SelectedNomination, Blank());
            ClearCollect(col_selectedUserNominee, Blank());
            ClearCollect(col_selectedUserProfile, Blank());

            Reset(Gallery1);
            Navigate(Loading_Screen);
        Visible: =Form2.Visible
```

**Impact:** New dedicated submit button with comprehensive state cleanup:

- Resets form fields
- Submits form data
- Clears all selection variables and collections
- Resets gallery selection
- Navigates back to loading screen for app refresh

#### 3.5 New Nominee Display Card

```yaml
DataCard2 As typedDataCard.blankCard:
  TextCanvas2 As Text:
    Text: ="Nominee:"

  "TextInputCanvas1 As 'Text input'":
    DisplayMode: =DisplayMode.View
    Placeholder: =var_selectedUser.DisplayName
    Value: =var_selectedUser.DisplayName
```

**Impact:** New read-only display card showing the selected nominee's name.

#### 3.6 Triage Status Dropdown Control (NEW)

```yaml
ComboboxCanvas2 As Combobox.pcfdataset:
  DisplayMode: =DisplayMode.Edit
  Fill: =RGBA(184, 0, 0, 1)
  Items: =(["Forward to Nursing Team", "Forward to HRO Team", "Forward to Public Affairs Team", "Forward to Starfish Team", "Return to Sender/Cancel"])
  OnChange: |-
    =Set(zzz_TriageStatus, Self.SelectedItems);
    Reset(DataCardValue32)
```

**Impact:** New combo box control replacing text input for triage status assignment with predefined team routing options:

- Forward to Nursing Team
- Forward to HRO Team
- Forward to Public Affairs Team
- Forward to Starfish Team
- Return to Sender/Cancel

#### 3.7 Enhanced Status Field Logic

```diff
  TriageStage_Status_Text_DataCard1:
      Default: |-
+         =If(
+             IsBlank(zzz_TriageStatus),
+             ThisItem.TriageStage_Status_Text,
+             ""
+         )
-         =ThisItem.TriageStage_Status_Text

      DataCardValue32:
+         Height: =0  # Hidden - replaced by ComboboxCanvas2
-         Height: =32
+         Placeholder: |-
+             =If(
+                 IsBlank(zzz_TriageStatus),
+                 ThisItem.TriageStage_Status_Text,
+                 ComboboxCanvas2.Selected.Value
+             )
```

**Impact:** Status text input now hidden with combo box overlay for guided selection.

#### 3.8 Auto-Fill Action By Field

```diff
  TriageStage_ActionTakenBy_Text_DataCard1:
      Default: |-
+         =If(
+             IsBlank(ThisItem.TriageStage_ActionTakenBy_Text),
+             User().Email,
+             DataCardValue33.Value
+         )
-         =ThisItem.TriageStage_ActionTakenBy_Text
+     Visible: =false  # Hidden but auto-populated

      DataCardValue33:
+         Placeholder: =User().Email
+         Value: =User().Email  # Auto-populated
```

**Impact:** Action taken by field now auto-populates with current user's email address.

#### 3.9 DataCard Width Standardization

All form data cards updated from `Width: =350` to `Width: =453` for consistent display.

---

### 4. Loading_Screen.fx.yaml â€“ Container Layout Update

```diff
  Loading_Container_Loading As groupContainer.manualLayoutContainer:
      ...
+     LayoutGridColumns: =6
+     LayoutGridRows: =6
```

**Impact:** Added explicit grid layout configuration for the loading container, enabling more precise control positioning.

---

### 5. Update_Screen.fx.yaml â€“ Container Grid Addition

```diff
  Update_PopUP_People As groupContainer.manualLayoutContainer:
      ...
+     LayoutGridColumns: =6
+     LayoutGridRows: =6
```

**Impact:** Consistent with Loading_Screen, added grid layout properties for popup container.

---

### 6. Control Package Upgrades

| Package          | v1.0.6 | v1.1.2 | Notes                                                              |
| ---------------- | ------ | ------ | ------------------------------------------------------------------ |
| `groupContainer` | 1.3.0  | 1.4.0  | New grid layout properties (`LayoutGridColumns`, `LayoutGridRows`) |

#### groupContainer 1.4.0 New Features:

- Added `LayoutGridColumns` property
- Added `LayoutGridRows` property
- Additional 30 lines of capability definition (+18% package growth)

---

### 7. File Size Changes

| Screen File                      | v1.0.6 Lines | v1.1.2 Lines | Change        |
| -------------------------------- | ------------ | ------------ | ------------- |
| `Triage_Screen.fx.yaml`          | 1,460        | 2,415        | +955 (+65%)   |
| `Screen_NewSubmission.fx.yaml`   | 6,219        | 6,272        | +53 (+0.9%)   |
| `ViewSubmissions_Screen.fx.yaml` | 3,241        | 3,363        | +122 (+3.8%)  |
| `Update_Screen.fx.yaml`          | 1,267        | 1,279        | +12 (+0.9%)   |
| `Loading_Screen.fx.yaml`         | 579          | 570          | -9 (-1.6%)    |
| `App.fx.yaml`                    | 473          | 473          | 0 (line count unchanged) |

---

### 8. New Files & Artifacts in v1.1.2

The v1.1.2 version includes new `.pa.yaml` files in the `Other/Src/` directory:

- `_EditorState.pa.yaml` (NEW)
- `App.pa.yaml`
- `CONSTRUCTION_Screen.pa.yaml`
- `Loading_Screen.pa.yaml`
- `Screen_NewSubmission.pa.yaml`
- `Screen_Submission_ICARE.pa.yaml`
- `Screen_Submissions_HinesHero.pa.yaml`
- `Screen_Submissions_HROSafetyStory.pa.yaml`
- `Submission_Screen_Nursing.pa.yaml`
- `Triage_Screen.pa.yaml`
- `Update_Screen.pa.yaml`
- `ViewSubmissions_Screen.pa.yaml`

**Impact:** These represent the Power Apps portable YAML format files, indicating adoption of newer source format conventions.

---

## ðŸš€ New Features Summary

1. **Triage Workflow Overhaul**

   - Dynamic form visibility based on selection state
   - Combo box team assignment with predefined routing options
   - Submit button with comprehensive state cleanup
   - Auto-populated "Action By" field with current user email
   - Improved form layout with responsive sizing

2. **Office365 API Migration**

   - Updated from `SearchUserV2` to `SearchUser` for user profile lookups

3. **Platform Modernization**

   - Upgraded MSAppStructureVersion from 2.0 to 2.4.0
   - Updated groupContainer control from 1.3.0 to 1.4.0
   - Added grid layout capabilities to containers
   - Disabled Copilot preview features

4. **Enhanced App Metadata**
   - Extended app description with GitHub repository link
   - Updated in-app version display to 1.1.x series

---

## ðŸ” Security & Compliance

- No new data sources added
- Existing SharePoint permission model maintained
- User email auto-population enhances audit trail accuracy
- All changes align with VA Healthcare security requirements

---

## ðŸ“± Compatibility

- **Power Platform CLI:** pac canvas pack/unpack compatible
- **Browser Support:** Unchanged (Edge, Chrome, Firefox)
- **Mobile Support:** Responsive design maintained
- **SharePoint Integration:** Full compatibility with existing lists

---

## ðŸ§ª Testing Recommendations

1. **Triage Workflow Testing**

   - Verify form visibility toggles correctly on gallery selection
   - Test all team routing options in combo box
   - Confirm "Action By" auto-population
   - Validate submit button clears all state variables

2. **User Profile Testing**

   - Verify `SearchUser` API returns expected results
   - Test user lookup across different email formats

3. **Regression Testing**
   - Confirm existing submission workflows unchanged
   - Verify award type selection behavior preserved
   - Test all navigation paths

---

## ðŸ“¦ Deployment Artifacts

- `v1.1.2.msapp` â€“ Packaged Canvas App for import
- `v1.1.2.zip` â€“ Original download from Power Apps portal
- `.unpacked/` â€“ Full source for version control and review

---

## ðŸ”— Related Documentation

- [CHANGELOG.md](../../../CHANGELOG.md) â€“ Full version history
- [README.md](./README.md) â€“ v1.1.2 component documentation
- [app-config.json](./app-config.json) â€“ Application configuration

---

## âœ… Commit Message Template

```
feat(power-apps): Release v1.1.2 - Triage workflow overhaul and platform modernization

Major Changes:
- Redesigned Triage_Screen with dynamic form visibility and team routing combo box
- Migrated Office365Users API from SearchUserV2 to SearchUser
- Upgraded MSAppStructureVersion from 2.0 to 2.4.0
- Updated groupContainer control to v1.4.0 with grid layout support
- Added auto-populated "Action By" field for improved audit trails
- Implemented submit button with comprehensive state cleanup

Technical Updates:
- Triage_Screen.fx.yaml: +955 lines (+65% growth) with new controls and logic
- Screen_NewSubmission.fx.yaml: +53 lines of minor refinements
- ViewSubmissions_Screen.fx.yaml: +122 lines of enhancements
- Loading_Screen.fx.yaml: Added LayoutGridColumns/LayoutGridRows properties
- Disabled Copilot preview features (enablecopilotcontrol, enablecopilotanswercontrol)
- Extended app description with GitHub repository reference

Breaking Changes: None
Security Impact: Enhanced audit trail with auto-populated user email
Testing: Triage workflow, user profile lookup, navigation paths
```

---

**Document Generated:** January 13, 2026
**Comparison Base:** v1.0.6 (archived at `archive/src/power-apps/v1.0.x/v1.0.6/.unpacked/`)
**Target Version:** v1.1.2 (source at `src/power-apps/v1.1.2/.unpacked/`)
